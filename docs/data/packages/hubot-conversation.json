{"_id":"hubot-conversation","_rev":"5-bd367357d4e25f1dcf411628665ac408","name":"hubot-conversation","description":"A utility for having conversation sessions with Hubot","dist-tags":{"latest":"1.1.1"},"versions":{"1.0.0":{"name":"hubot-conversation","version":"1.0.0","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","hubot":"^2.16.0","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3"},"gitHead":"2a1537f2e0982d961e2e455729c2f8d4942b16e4","_id":"hubot-conversation@1.0.0","_shasum":"643b33deabce908ea37546efc7dd798322e774cf","_from":".","_npmVersion":"2.13.4","_nodeVersion":"0.12.7","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"dist":{"shasum":"643b33deabce908ea37546efc7dd798322e774cf","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.0.0.tgz"},"directories":{}},"1.0.1":{"name":"hubot-conversation","version":"1.0.1","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"pre-commit":["test"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","grunt-mocha-istanbul":"^3.0.1","hubot":"^2.16.0","istanbul":"^0.3.21","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3","pre-commit":"^1.1.1"},"gitHead":"77134b121e9d06fae9b29c11e0f989433c3e2525","_id":"hubot-conversation@1.0.1","_shasum":"f4b7cc736f0c1de796eb16a7105abc386b467bcf","_from":".","_npmVersion":"2.13.4","_nodeVersion":"0.12.7","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"dist":{"shasum":"f4b7cc736f0c1de796eb16a7105abc386b467bcf","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.0.1.tgz"},"directories":{}},"1.0.2":{"name":"hubot-conversation","version":"1.0.2","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"pre-commit":["test"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","grunt-mocha-istanbul":"^3.0.1","hubot":"^2.16.0","istanbul":"^0.3.21","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3","pre-commit":"^1.1.1"},"gitHead":"a235ea8311e129b958f26b191c2207f22f2d96af","_id":"hubot-conversation@1.0.2","_shasum":"0a6605f64a6cded15f5089dad16c8d91ab33a06b","_from":".","_npmVersion":"2.13.4","_nodeVersion":"0.12.7","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"dist":{"shasum":"0a6605f64a6cded15f5089dad16c8d91ab33a06b","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.0.2.tgz"},"directories":{}},"1.0.3":{"name":"hubot-conversation","version":"1.0.3","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"pre-commit":["test"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","grunt-mocha-istanbul":"^3.0.1","hubot":"^2.16.0","istanbul":"^0.3.21","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3","pre-commit":"^1.1.1"},"dependencies":{"debuglog":"^1.0.1"},"gitHead":"3cd025fde448cada0a4cd9b594bf28ea9f738f32","_id":"hubot-conversation@1.0.3","_shasum":"c8e3c4edbbe1e579ae78e40ae696a30a8cc61581","_from":".","_npmVersion":"3.3.12","_nodeVersion":"5.3.0","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"dist":{"shasum":"c8e3c4edbbe1e579ae78e40ae696a30a8cc61581","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.0.3.tgz"},"directories":{}},"1.1.0":{"name":"hubot-conversation","version":"1.1.0","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"pre-commit":["test"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","grunt-mocha-istanbul":"^3.0.1","hubot":"^2.16.0","istanbul":"^0.3.21","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3","pre-commit":"^1.1.1"},"dependencies":{"debuglog":"^1.0.1"},"gitHead":"562448e4864618262ca0dc8ffdd382094aa58720","_id":"hubot-conversation@1.1.0","_shasum":"53ca785d7c50a97edd89cdbf5926889fc45002f0","_from":".","_npmVersion":"3.5.3","_nodeVersion":"4.2.4","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"dist":{"shasum":"53ca785d7c50a97edd89cdbf5926889fc45002f0","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.1.0.tgz"},"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-conversation-1.1.0.tgz_1463362202256_0.5775385494343936"},"directories":{}},"1.1.1":{"name":"hubot-conversation","version":"1.1.1","description":"A utility for having conversation sessions with Hubot","main":"index.js","scripts":{"test":"grunt test"},"pre-commit":["test"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"keywords":["hubot","slack","conversation","session"],"author":{"name":"@lmarkus"},"license":"ISC","bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","devDependencies":{"chai":"^3.3.0","coffee-script":"^1.10.0","eslint":"^1.5.1","grunt":"^0.4.5","grunt-eslint":"^17.2.0","grunt-mocha-istanbul":"^3.0.1","hubot":"^2.16.0","istanbul":"^0.3.21","load-grunt-tasks":"^3.3.0","mocha":"^2.3.3","pre-commit":"^1.1.1"},"dependencies":{"debuglog":"^1.0.1"},"gitHead":"cd2f536d009b348f3f3047cf6a29d73b0510c80e","_id":"hubot-conversation@1.1.1","_shasum":"f80937ea922e7be9b55ec3e859466568a5fda76d","_from":".","_npmVersion":"3.5.3","_nodeVersion":"4.2.4","_npmUser":{"name":"lmarkus","email":"lmarkus@paypal.com"},"dist":{"shasum":"f80937ea922e7be9b55ec3e859466568a5fda76d","tarball":"http://registry.npmjs.org/hubot-conversation/-/hubot-conversation-1.1.1.tgz"},"maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/hubot-conversation-1.1.1.tgz_1464888412105_0.396260567009449"},"directories":{}}},"readme":"# Hubot-Conversation\n\nHave a multi-message chat with your bot.\n\n#####Reminder, before you start: This does *not* need to be added to [external-scripts.](https://github.com/lmarkus/hubot-conversation/issues/4)\n##How it works:\n\n1) Make a new `Conversation` instance aware of your robot:\n    \n   ```javascript\n   var switchBoard = new Conversation(robot, [type]);\n   ```\n    \nThis will register a custom listener allowing the instance to check all incoming messages. Type parameter can take one of two values: `user` (default) or `room`. It defines if this conversation is with the whole room or with a particular user only.\nIf the message comes from a user (or a room) that we're having a conversation with, it will be processed as the next step in an ongoing Dialog.\n\n2) Given an starting message, create a new Dialog instance and give the dialog choices.\n  \n  ```javascript\n  robot.hear(/delete all the files/, function(msg) {\n  \n      msg.reply('Are you really sure???');\n      \n      //Start a dialog with the user that sent this message.\n      var dialog = switchBoard.startDialog(msg);\n      \n      //Provide choices for the next step, wait for the user.\n      dialog.addChoice(/yes/, function(msg2){/*Do some stuff for the yes option*/}\n      dialog.addChoice( /no/, function(msg2){/*Do some stuff for the no option*/ }\n  \n      //The dialog will expire after 30 secods.  \n  });\n  ```\n\nThe switchBoard will listen to the next message from the same user (or room) and try to match it to any of the available choices.\nAfter a match has been found. It will clear the choices, and end the dialog.\n\nThe bot will forget about your dialog after a default timeout of 30 seconds.\n\n##Use\n\nOn your hubot script:\n\n```javascript\n\nvar Conversation = require('hubot-conversation');\nmodule.exports = function (robot) {\n\n    var switchBoard = new Conversation(robot);\n\n    robot.respond(/clean the house/, function (msg) {\n        var dialog = switchBoard.startDialog(msg);\n\n        msg.reply('Sure, where should I start? Kitchen or Bathroom');\n        dialog.addChoice(/kitchen/i, function (msg2) {\n            msg2.reply('On it boss!');\n        });\n        dialog.addChoice(/bathroom/i, function (msg2) {\n            msg.reply('Do I really have to?');\n            dialog.addChoice(/yes/, function (msg3) {\n                msg3.reply('Fine, Mom!');\n            })\n        });\n    });\n\n    robot.respond(/jump/, function (msg) {\n        var dialog = switchBoard.startDialog(msg);\n        msg.reply('Sure, How many times?');\n        \n        dialog.addChoice(/([0-9]+)/i, function (msg2) {\n            var times = parseInt(msg2.match[1], 10);\n            for (var i = 0; i < times; i++) {\n                msg.emote(\"Jumps\"); //We can use the original message too.\n            }\n        });\n    });\n    \n    \n  robot.respond(/.*the mission/, function (msg) {\n        msg.reply('Your have 5 seconds to accept your mission, or this message will self-destruct');\n        var dialog = switchBoard.startDialog(msg, 5000); //5 Second timeout\n        dialog.timeout = function (msg2) {\n            msg2.emote('Boom');\n        }\n        dialog.addChoice(/yes/i, function (msg2) {\n            msg2.reply('Great! Here are the details...');\n        });\n    });\n};\n```\n\nThis will give you the following interactions:\n\n```bash\nhubot> hubot clean the house\nhubot> Shell: Sure, where should I start? Kitchen or Bathroom\nhubot> Kitchen\nhubot> Shell: On it boss!\nhubot> hubot clean the house\nhubot> Shell: Sure, where should I start? Kitchen or Bathroom\nhubot> Bathroom\nhubot> Shell: Do I really have to?\nhubot> yes\nhubot> Shell: Fine, Mom!\n\n```\n\n```bash\nhubot> hubot jump\nhubot> Shell: Sure, How many times?\nhubot> 3\nhubot> ready to jump 3 3\n* Jumps\n* Jumps\n* Jumps\n```\n\n```bash\nhubot> hubot what's the mission?\nhubot> Shell: Your have 5 seconds to accept your mission, or this message will self-destruct\n//5 seconds later\n* Boom  \n```\n\n\n##API\n\n###Conversation\n\n##### startDialog(msg, [timeout])\n\nReturns a new Dialog object, with a default timeout of 30000ms.\n\n**msg**: An incoming message heard / responded to by the robot\n eg: \n  \n ```javascript\n robot.respond(/foo/,function(msg){ \n    var dialog = conversation.startDialog(msg);\n })\n ```\n \n **timeout**: optional time in ms before the conversaion expires.\n The Dialog object has a default `timeout` function property which can be overriden to specify the timeout behavior\n \n##### talkingTo(id)\n \n Returns the Dialog being held with a given user\n \n **id**: The Id of the user with whom a dialog is taking place.\n \n \n### Dialog\n A multiple-choice message handler\n \n##### receive(msg)\n \n Process an incoming message to see if any choice matches it.\n \n **msg** A hubot message\n \n##### addChoice(regex, handler)\n \n Adds a listener choice to this Dialog. This works just like hubots `hear` listener. \n If a message is received that matches the choice `regex`, the handler will be executed.\n  \n **regex** a regular expresion that will be aplied to the incoming message from the receive function\n **handler**: function(message),  A function that is executed against a successfully matched message. The `match` property of the original \n message is replaced by the match against this regex, so you can retrieve matched groups.\n\n##### getChoices()\n \n Returns the array of choices\n \n##### resetChoices()\n\n Clears the choices.\n \n##### dialogTimeout -> function(message){ }\nDefault timeout handler.  You can override this property with your own function.\n\n","maintainers":[{"name":"lmarkus","email":"lmarkus@paypal.com"}],"time":{"modified":"2018-02-08T21:03:20.163Z","created":"2015-10-02T21:43:14.074Z","1.0.0":"2015-10-02T21:43:14.074Z","1.0.1":"2015-10-05T05:32:46.541Z","1.0.2":"2015-11-09T23:14:15.271Z","1.0.3":"2015-12-21T20:11:55.145Z","1.1.0":"2016-05-16T01:30:04.704Z","1.1.1":"2016-06-02T17:26:53.508Z"},"homepage":"https://github.com/lmarkus/hubot-conversation#readme","keywords":["hubot","slack","conversation","session"],"repository":{"type":"git","url":"git+https://github.com/lmarkus/hubot-conversation.git"},"author":{"name":"@lmarkus"},"bugs":{"url":"https://github.com/lmarkus/hubot-conversation/issues"},"license":"ISC","readmeFilename":"README.md","users":{"audstanley":true,"ggyax":true,"ukuli":true,"victorquinn":true,"vghhkjh":true}}
