{"_id":"hubot-weixin","_rev":"13-227ee8d0bf586c90a80612badd6a03b6","name":"hubot-weixin","description":"This is wechat/weixin adapter for hubot","dist-tags":{"hubot-weixin@1.0.0":"1.0.0","latest":"1.0.8","hubot-weixin@1.0.1":"1.0.1"},"versions":{"1.0.0":{"name":"hubot-weixin","version":"1.0.0","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"kasperdeng","email":"kasper.deng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.0","scripts":{},"_shasum":"e02d0c27870946ea00e4e54c009c18c125411d9b","_from":".","_npmVersion":"2.14.4","_nodeVersion":"4.1.2","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"e02d0c27870946ea00e4e54c009c18c125411d9b","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.0.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-13-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.0.tgz_1457415443237_0.8924659197218716"},"directories":{}},"1.0.1":{"name":"hubot-weixin","version":"1.0.1","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"kasperdeng","email":"kasper.deng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.1","scripts":{},"_shasum":"87ad3d816fed4d0797aec3f58da7a3d886c07256","_from":".","_npmVersion":"2.14.4","_nodeVersion":"4.1.2","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"87ad3d816fed4d0797aec3f58da7a3d886c07256","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.1.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.1.tgz_1457537290121_0.3119903316255659"},"directories":{}},"1.0.2":{"name":"hubot-weixin","version":"1.0.2","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"kasperdeng","email":"kasper.deng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.2","scripts":{},"_shasum":"1773686fd66227882e5dfa61ecdf210b78f46d19","_from":".","_npmVersion":"2.14.4","_nodeVersion":"4.1.2","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"1773686fd66227882e5dfa61ecdf210b78f46d19","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.2.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.2.tgz_1457755564292_0.32944907573983073"},"directories":{}},"1.0.3":{"name":"hubot-weixin","version":"1.0.3","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"kasperdeng","email":"kasper.deng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.3","scripts":{},"_shasum":"0a300f850b33e7cc70879f2c88be5e837eae3b31","_from":".","_npmVersion":"2.14.4","_nodeVersion":"4.1.2","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"0a300f850b33e7cc70879f2c88be5e837eae3b31","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.3.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.3.tgz_1459686451241_0.7818125358317047"},"directories":{}},"1.0.4":{"name":"hubot-weixin","version":"1.0.4","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.4","scripts":{},"_shasum":"a3edef2bb49ab338f9615b9be9ede3be76b525aa","_from":".","_npmVersion":"2.14.4","_nodeVersion":"4.1.2","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"a3edef2bb49ab338f9615b9be9ede3be76b525aa","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.4.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.4.tgz_1460355727894_0.0802125632762909"},"directories":{}},"1.0.5":{"name":"hubot-weixin","version":"1.0.5","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.5","scripts":{},"_shasum":"b8d3200d602b8315ca6305f248c9f1325f55da87","_from":".","_npmVersion":"2.15.1","_nodeVersion":"4.4.4","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"b8d3200d602b8315ca6305f248c9f1325f55da87","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.5.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.5.tgz_1464370747519_0.6976064187474549"},"directories":{}},"1.0.6":{"name":"hubot-weixin","version":"1.0.6","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"_id":"hubot-weixin@1.0.6","scripts":{},"_shasum":"b10b43fe2e0f63ee0f0ee2487d1b7fbf25ffaafd","_from":".","_npmVersion":"2.15.1","_nodeVersion":"4.4.4","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"b10b43fe2e0f63ee0f0ee2487d1b7fbf25ffaafd","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.6.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.6.tgz_1464457483271_0.18607576261274517"},"directories":{}},"1.0.7":{"name":"hubot-weixin","version":"1.0.7","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^3.10.1","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"144694d1b610794058b18884e91e0331e5e69f93","_id":"hubot-weixin@1.0.7","scripts":{},"_shasum":"04ef5a32fe66b4a96b76b0cd9dc8d12cf798f4cf","_from":".","_npmVersion":"3.10.3","_nodeVersion":"6.3.1","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"04ef5a32fe66b4a96b76b0cd9dc8d12cf798f4cf","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.7.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.7.tgz_1476764183245_0.4515486271120608"},"directories":{}},"1.0.8":{"name":"hubot-weixin","version":"1.0.8","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"144694d1b610794058b18884e91e0331e5e69f93","_id":"hubot-weixin@1.0.8","scripts":{},"_shasum":"594c5237a7a58cc7d74e9320dcc6da3a3619a7c3","_from":".","_npmVersion":"3.10.3","_nodeVersion":"6.3.1","_npmUser":{"name":"kasperdeng","email":"kasperdeng@126.com"},"dist":{"shasum":"594c5237a7a58cc7d74e9320dcc6da3a3619a7c3","tarball":"https://registry.npmjs.org/hubot-weixin/-/hubot-weixin-1.0.8.tgz"},"maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-1.0.8.tgz_1476769068634_0.18482806300744414"},"directories":{}}},"readme":"# ![weixin](http://weixin.qq.com/zh_CN/htmledition/images/favicon1fbcbe.ico)  Hubot-Weixin \n  - hubot [![hubot version](https://img.shields.io/npm/v/hubot.svg?style=plastic)](https://github.com/github/hubot) \n  - hubot-weixin [![hubot-weixin version](https://img.shields.io/npm/v/hubot-weixin.svg?style=plastic)](https://github.com/KasperDeng/Hubot-WeChat) \n  - npm [![npm version](https://img.shields.io/npm/v/npm.svg?style=plastic)](https://www.npmjs.com/package/hubot-weixin)\n  - nodejs [![node version](https://img.shields.io/node/v/latest-version.svg?style=plastic)](https://nodejs.org/en/)\n\n* [中文版](https://github.com/KasperDeng/Hubot-WeChat/blob/master/README-zh.md)\n* This is wechat/weixin adapter for hubot.\n* Notation: wechat is another name for the popular App weixin in China\n* Goal\n  - login once, run anywhere, anytime\n  - Make life easier and let bot do something for us in backend\n\n## Features of Hubot-WeChat (WeChat Adapter) ##\n* Basic functions as that in WeChat Web\n  - Auto-reply text to group\n  - Auto-reply media to group\n  - Auto-reply to specific person\n* Auto-report status to maintainer\n* A forever script to launch the hubot instance and mornintoring\n* Aboundants of scripts for hubot\n  - integrated with jenkins\n  - integrated with [turing robot](http://www.tuling123.com/)\n  - Lots of life information by querying the APIs provided from baidu api-store\n\n## Wechat Adapter Configuration ##\n\n### Basic Config ###\n* The hubot needs a real WeChatID\n* The hubot's WeChatID should be include in the group to be listened on for auto-reply\n* The group/specific person should be save into that contact list\n\n### config.yaml ###\n* A config.yaml is provided to set the configuration items \n  - Those items most are for wechat login in Hubot-WeChat startup\n\n* Get config items method\n  - Login the wechat from browser, use the wechatId which is used for hubot\n  - **Capture data from webwxinit api from browser debug mode**\n\n* url\n  - baseUrl -- wx/wx2\n  - baseUploadUrl -- file/file2\n  - Wechat server has traffic distribution to WX/WX2 server dependent on hubot's WeChat ID \n\n* Below data are needed and set into config.yaml apporiated fields \n  - header\n    + cookie\n  - BaseRequest\n    + Uin\n    + Sid\n    + Skey\n    + DeviceId\n\n* maintainerName\n  - Please fill the maintainer's wechat name (the maintainer should be in hubot's wechat contact list) \n  - Hubot will report its online status to maintainer in a configured interval\n\n* webWxSyncInterval\n  - To sync receiving message from WX server\n  - Default: 1500 ms \n\n* syncCheckInterval\n  - It is the heartbeat to WX server \n  - To trick WX server the login persion still on the web wechat\n  - Default: 30s, it is same behavior in web wechat\n\n* listenOnAllGroups\n  - default value: true. Then hubot will listen on all the group where it is in\n\n* listenGroupNameList\n  - It is used to control hubot only listen on some group for auto reply \n\n* Other config item: it's simple to know from its meaning and you can check the code for its usage\n\n## Start Up ##\n\n### by docker ###\n* `docker pull kasperdeng/hubot-weixin`\n  - size 83M, based on alpine linux\n* Please prepare below config files on host\n  - config.yaml with your login info: cookie, Uin, SKey, deviceId\n    + For starting in docker, please set `logToFile: true` and `wxLogPath: \"/root/hubot/wxhubot.log\"`\n    + e.g. `/home/kasper/dockerHubot/config.yaml`\n  - Your scripts directory\n    + e.g. `/home/kasper/dockerHubot/scripts`\n* start-up command. Please note using `-v`(volume) to map your config file and log file path on your host.\n  - `docker run -d -v /home/kasper/dockerHubot/scripts:/root/hubot/scripts -v /home/kasper/dockerHubot/config.yaml:/root/hubot/node_modules/hubot-weixin/config.yaml -v /home/kasper/dockerHubot/wxhubot.log:/root/hubot/wxhubot.log kasperdeng/hubot-weixin`\n  - Use this command to enter the docker instance for debugging. `docker run -it -v /home/kasper/dockerHubot/scripts:/root/hubot/scripts -v /home/kasper/dockerHubot/config.yaml:/root/hubot/node_modules/hubot-weixin/config.yaml -v /home/kasper/dockerHubot/wxhubot.log:/root/hubot/wxhubot.log kasperdeng/hubot-weixin /bin/sh`\n* About the image `kasperdeng/hubot-weixin`, please refer to [Dockfile](https://www.github.com/kasperdeng/docker-hubot-weixin)\n\n### by npm ###\n* First, setup hubot(details in [Hubot official](https://hubot.github.com))\n* add `hubot-weixin`to hubot's package.json\n* run `npm install` in your hubot dir\n* start hubot: `bin/hubot -a weixin`\n\n### by git pulling ###\n* Pull hubot-weixin from here\n* Make symbolic link to your hubot-weixin in Hubot'snode_modules\n  - `npm link <your hubot-weixin dir>`\n* start hubot: `bin/hubot -a weixin`\n\n\n## Design & Implementation Notes ##\n* The problem\n  - Scanning the QR code to login web wechat\n  - No published official WeChat api interface\n* Workaround for login\n  - Need login manually by scanning the QR code once\n  - Capture all the required data as hubot configuration(details in next slide) \n* Shoot the trouble\n  - Use chrome/firefox to analyze web WeChat API\n  - Try its web APIs by curl\n  - Analyze the parameters and what it is\n  - Analyze the wxApp.js\n* Notes:\n  - **The hubot wechat on the mobile side keeps online is preferred**\n  - Reason: WeChat server disconnects your hubot with websync failure after 3~4 days. \n    But hubot works again once login mobile wechat app again.\n\n## The Adapter Software Hierachy ##\n* Operations in our Wechat-Hubot\n  - wxbot.coffee\n\t\n* The coffeescript version's WxChat Web APIs\n  - wxApi.coffee\n\n* The http layer, including sync and async\n  - httpclient.coffee\n\n## Integrate Adapter to Hubot ##\n* Implement the needed methods of adapter\n  - constructor\n    + Getting the hubot robot \n  - send\n    + hubot sends out message to specific persion/group\n  - reply \n    + hubot replies message to specific persion/group\n  - run\n    + New a WxBot\n    + Being called in hubot launching\n      It is used to init the wechat groups information\n    + Integrate to Hubot by calling\n\n    ~~~\n    @emit 'connected'\n    ~~~\n* Implement a callback to call hubot's receive method to get the incoming message\n\n## SDE ##\n* [Getting Started With Hubot](https://hubot.github.com/docs/) on Windows/Unix-Like\n* Backlog management\n  - [kanbanflow](https://kanbanflow.com/board/23ec47145de7783b8cf2e80187538b5b)\n* Version control\n  - git \n* IDE\n  - Sublime\n  - or WebStorm/Vim\n* DevEnv\n  - Nodejs and npm\n  - Use `npm install` to get all the node modules\n    + Inside greatwall, add option `--registry=https://registry.npm.taobao.org`\n* Programming Language\n  - coffeeScript\n  - coffeelint to checkstyle \n\n## How to write Your Scripts? ##\n* Please refer to the scirpts in repo\n* Follow the coding style\n* The `msg` in the scripts provides the http asycn function to get your data from open APIs\n\n## Test Your Script ##\n* With shell adapter\n* Use your WeChat ID to test\n\n## Contributor ##\n* bumblebee team \n  - [Jeff Zhu](https://github.com/kfchu)\n  - [Yinsong Ma](https://github.com/eyinsma)\n  - [Kasper Deng](https://github.com/kasperdeng)\n\n* [Shouxi Huang](https://github.com/hsx1612727380)\n\n## TODO ##\n* No much functions to be implemented, most are focus on scripting\n* Unit test\n\n## Reference ##\n* [Hubot Official](https://hubot.github.com)\n* [About WxChat Web API](https://github.com/hexcola/wxplugin/blob/master/protocal_2.md)\n* [How to write your adapter?](https://hubot.github.com/docs/adapters/development/)\n\n## License ##\n* See the [LICENSE](https://github.com/KasperDeng/Hubot-WeChat/blob/master/LICENSE) file for license rights and limitations (MIT).\n\n","maintainers":[{"name":"kasperdeng","email":"kasperdeng@126.com"}],"time":{"modified":"2016-11-19T04:50:06.202Z","created":"2016-03-08T05:37:25.314Z","1.0.0":"2016-03-08T05:37:25.314Z","1.0.1":"2016-03-09T15:28:12.416Z","1.0.2":"2016-03-12T04:06:04.685Z","1.0.3":"2016-04-03T12:27:33.561Z","1.0.4":"2016-04-11T06:22:08.888Z","1.0.5":"2016-05-27T17:39:10.857Z","1.0.6":"2016-05-28T17:44:43.788Z","1.0.7":"2016-10-18T04:16:25.451Z","1.0.8":"2016-10-18T05:37:50.519Z"},"keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","readmeFilename":"README.md","users":{"kasperdeng":true,"dofy":true},"_attachments":{}}