{"_id":"hubot-alterdesk","_rev":"1-33fde5f23e8790c00efc906e707113d3","name":"hubot-alterdesk","dist-tags":{"latest":"1.0.2"},"versions":{"1.0.1":{"name":"hubot-alterdesk","version":"1.0.1","description":"Alterdesk adapter for hubot","main":"./src/alterdesk.js","scripts":{"test":"mocha test/*.js"},"repository":{"type":"git","url":"git+https://github.com/Alterdesk/hubot-alterdesk-adapter.git"},"author":"","license":"MIT","dependencies":{"hubot":"^3.3.2","node-messenger-log":"^1.0.0","ws":"^7.1.1"},"gitHead":"0ecd428deb5989370ecc5baed348a603aada074e","bugs":{"url":"https://github.com/Alterdesk/hubot-alterdesk-adapter/issues"},"homepage":"https://github.com/Alterdesk/hubot-alterdesk-adapter#readme","_id":"hubot-alterdesk@1.0.1","_npmVersion":"6.4.1","_nodeVersion":"8.10.0","_npmUser":{"name":"developer_alterdesk","email":"info@alterdesk.com"},"dist":{"integrity":"sha512-Cbex0s+qVdV50RyFA6WzK0GhqwvIcIG4KGECZHk04pZJttMgHW3/7e7SHpn0QdqYcdzFwYJLk+Op2x6VeFHaoA==","shasum":"be0b4001e1f67c50003786f27bc2b41d2cc0a060","tarball":"https://registry.npmjs.org/hubot-alterdesk/-/hubot-alterdesk-1.0.1.tgz","fileCount":4,"unpackedSize":35787,"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJep/lqCRA9TVsSAnZWagAAw24P/0k+Dv0BPU2XjaBhSJ1p\n29i6becf/Uk+piAy5cm9XoJVVoiiJhI+U46Qdl3lfypovome0kmgATpI8CHT\nW0IzCUUsv4VouZWsZuH9+BN/wNVWgl4i00/P3oFylne09pxybQvZuNsJDR9e\nz31nlTXXDfBLu4nSjypUTe6dA7M8sbQob9V7tfariA70j5UNPTdY3n25kRKj\nYiBYKGHAIpPnpmaAd5IvOGU9XUmiJjk6H87BoFBdPyE1kc/ivcAaYRiJDZ8h\nRkai+D3zC/O9OSizz+bWc5hP2boZGzoGDvbCuuq+JeIk6jvw2UTeaQt62gs3\nd3ptZKdrs4u32o81zKyfe/BgEOOn9HHfNWh/+6IRM/RlrNqsgpV2w7cOuqQe\nCFfv5tQMdHSIko+lQsaJuKoMqF2WC/ZfM1KowlGAchYbDb7qQFEl3m90C1JR\nniUt+SUPNwJW5VbZftghWoo8y+1l5sVxyHRMnDop0lP6oPGuQuwAmb4Sl3CZ\n1OJd+O3N5c8svgERhcMjLG9YFoJjNFQrMBZaZ6ldvlbj86ozZYhH3J1mcvkX\n3mA7RFc/HS0RYYnZG0DXXcy/VTLDgP9wPOEXLQP04CQwRCLeToNPBFF8mvx4\n0vJDMyngEW1ZNnCgmvGOv5F6qLroAkaUr0LGypTrXxUxaKCFeDQbBDbhEWaL\nZcIC\r\n=lqvx\r\n-----END PGP SIGNATURE-----\r\n"},"maintainers":[{"name":"developer_alterdesk","email":"info@alterdesk.com"}],"directories":{},"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/hubot-alterdesk_1.0.1_1588066666065_0.35262948837543817"},"_hasShrinkwrap":false},"1.0.2":{"name":"hubot-alterdesk","version":"1.0.2","description":"Alterdesk adapter for hubot","main":"./src/alterdesk.js","scripts":{"test":"mocha test/*.js"},"repository":{"type":"git","url":"git+https://github.com/Alterdesk/hubot-alterdesk-adapter.git"},"author":"","license":"MIT","dependencies":{"hubot":"^3.3.2","node-messenger-log":"^1.0.0","ws":"^7.1.1"},"gitHead":"10d847dc997b890662c7f2d61e282d8106322da1","bugs":{"url":"https://github.com/Alterdesk/hubot-alterdesk-adapter/issues"},"homepage":"https://github.com/Alterdesk/hubot-alterdesk-adapter#readme","_id":"hubot-alterdesk@1.0.2","_npmVersion":"6.4.1","_nodeVersion":"8.10.0","_npmUser":{"name":"developer_alterdesk","email":"info@alterdesk.com"},"dist":{"integrity":"sha512-xefhILgcPIt2+u4Dapjp6nwxxhwMfS0yDw/Kwus3x28TwT7MNLEw213eG1oO9f6di6fIClbrafiU8UygR9irgA==","shasum":"f7e9064fb269f00f38451e3fcf68c0805638f1df","tarball":"https://registry.npmjs.org/hubot-alterdesk/-/hubot-alterdesk-1.0.2.tgz","fileCount":4,"unpackedSize":35787,"npm-signature":"-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJetTJxCRA9TVsSAnZWagAAWAMP/RRSyIk07MAUlZAslZd7\nR3XlpPmSGoIhaZmMifQm86HP3uEz2LOustu9UGXdlsIOspZbAq7NRPGrbGOs\nkEbmUXtuwctnPgBKFxaaxWhmT0ceHnBdsu3r2lJtG4plT1kCPqY/9QalgVUG\n3qXpZxmQFiNfVT+6IlG4lkn8DdIUbm3ysrOjdBnHONMfsodne8d/26ZctoVg\n5/G8KMcirmP6mVp8yn7/qqB6e/GKipmYDt1oxBF8Y4PZhv7Xpsam673OC1o5\nTpm/ftQdy2Y7L/eZBG0UtqBwtoTLF5CUi78XlRvnXcsDUurmAVM0GdALz8Jg\nuzVYKo6DkXC5Is6VEyT2H/IJJa+cq9PO1mhrITq5SzCF3Enkg2F50kGNIDee\nEXoPb7aB+PrW6h4JI+uf+NCktpdVwxmYwktTDciFAzPGtqxhEwsCTGeULi2i\nGYfRAccp6+gOAFTEweqD9P2gRfE7AOS7QVejT8dNKZultOvUB3WnPPUxYwCg\n8sE0PfdUXIDnqW3de8azj7WPz6AO9Jw+HbUJ5TCIUw7Os+GDj28UgnnKx9fP\naXRzV3Z60Uha4ZS83qZkGyIoTYduo4vcJutUSw3MJFCQIiZGF8W8u5A6mMo0\niqATkBPkF1yjFRP5Dt2MGDPI/jeoZCQi3mPs7B04IDlhxNj/oda4uNzAlcdl\nZavP\r\n=PcoL\r\n-----END PGP SIGNATURE-----\r\n"},"maintainers":[{"name":"developer_alterdesk","email":"info@alterdesk.com"}],"directories":{},"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/hubot-alterdesk_1.0.2_1588933232569_0.5688773147777602"},"_hasShrinkwrap":false}},"time":{"created":"2020-04-28T09:37:46.064Z","1.0.1":"2020-04-28T09:37:46.208Z","modified":"2020-05-08T10:20:36.304Z","1.0.2":"2020-05-08T10:20:32.712Z"},"maintainers":[{"name":"developer_alterdesk","email":"info@alterdesk.com"}],"description":"Alterdesk adapter for hubot","homepage":"https://github.com/Alterdesk/hubot-alterdesk-adapter#readme","repository":{"type":"git","url":"git+https://github.com/Alterdesk/hubot-alterdesk-adapter.git"},"bugs":{"url":"https://github.com/Alterdesk/hubot-alterdesk-adapter/issues"},"license":"MIT","readme":"# Hubot Alterdesk Adapter\n\nAdapter to connect a [Hubot](https://hubot.github.com/) instance to the \n[Alterdesk Gateway API](https://api.alterdesk.com/documentation/gateway)\n\nDependencies\n* [ws](https://github.com/websockets/ws)\n\n## Usage\nTo use the adapter, set at least the OAuth 2.0 token for Alterdesk API as an environment variable in your Hubot startup script.\n\nBash script, usually located at *hubot/bin/hubot*\n```sh\n#!/bin/sh\n\nset -e\n\nexport PATH=\"node_modules:node_modules/.bin:node_modules/hubot/node_modules/.bin:$PATH\"\n\nexport HUBOT_ALTERDESK_TOKEN=<ALTERDESK_API_TOKEN>\n\nexec node_modules/.bin/hubot --name \"hubot\" --adapter \"alterdesk\" \"$@\"\n\n```\n\nBatch script, usually located at *hubot/bin/hubot.cmd*\n```batch\n@echo off\n\nSETLOCAL\nSET PATH=node_modules\\.bin;node_modules\\hubot\\node_modules\\.bin;%PATH%\n\nSET HUBOT_ALTERDESK_TOKEN=<ALTERDESK_API_TOKEN>\n\nnode_modules\\.bin\\hubot.cmd --name \"alterdeskbot\" --adapter \"alterdesk\" %*\n```\n\n## Environment variables\nUsing enviroment variables various settings can be changed, only the API token variable that is mandatory.\n\n### Connection settings\nHUBOT_ALTERDESK_TOKEN\n* OAuth 2.0 token for the Alterdesk API\n\nHUBOT_ALTERDESK_HOST\n* Host and port of the Alterdesk API *(default: api.alterdesk.com:443)*\n\nHUBOT_ALTERDESK_RECONNECT_TRY\n* Amount of retries to reconnect to Alterdesk *(default: 5)*\n\nHUBOT_ALTERDESK_RECONNECT_WAIT\n* Milliseconds to wait for a reconnect attempt *(default: 5000)*\n\nHUBOT_ALTERDESK_SSL\n* Use SSL to connect to Alterdesk. *(0 = off, 1 = on, default: 1)*\n\n### Message settings\nHUBOT_ALTERDESK_PM_PREFIX\n* Message from Alterdesk always have the robot name as a prefix(to trigger Hubot). *(0 = off, 1 = on, default: 1)*\n\nHUBOT_ALTERDESK_TYPING_DELAY\n* Milliseconds to show Hubot as \"Typing...\" before sending message to Alterdesk *(default: 2500)*\n\nHUBOT_ALTERDESK_TYPING_DELAY_FACTOR\n* Milliseconds to show Hubot as \"Typing...\" per character before sending message to Alterdesk, overrides \nHUBOT_ALTERDESK_TYPING_DELAY if set\n\nHUBOT_ALTERDESK_TYPING_DELAY_MIN\n* Set a minimum of milliseconds to use with HUBOT_ALTERDESK_TYPING_DELAY_FACTOR \n\nHUBOT_ALTERDESK_TYPING_DELAY_MAX\n* Set a maximum of milliseconds to use with HUBOT_ALTERDESK_TYPING_DELAY_FACTOR\n\n### Group chat settings\nHUBOT_ALTERDESK_AUTOJOIN\n* Should automatically join group chats. *(0 = off, 1 = on, default: 1)*\n\nHUBOT_ALTERDESK_GROUPCHAT_CACHEFILE\n* Group chat join cache file location *(default: groupchat_cache.json)*\n\n### Error handling settings\nHUBOT_ALTERDESK_EXIT_ON_ERROR\n* Stop the hubot process on uncaught exceptions *(0 = off, 1 = on, default: 1)*\n\nHUBOT_ALTERDESK_LOG_ERRORS\n* Should write uncaught exception errors to log file. *(0 = off, 1 = on, default: 1)*\n\nHUBOT_ALTERDESK_ERROR_LOG_FILE\n* Log file location to write uncaught exception errors in *(default: hubot_error.log)*\n\n## Behaviour\n\n### Authentication\nWhen Hubot is authenticated on Alterdesk, an [authentication event](#Authentication Events) is received as a \nTopicMessage. The chat ids that are set in the cache file will be joined when auto join is enabled. When auto join is \ndisabled, the cache file can be used to limit Hubot to certain group chats.\n\n### One to one chat\nSending and receiving messages in a chat with a single user behave like normal Hubot chats.\n\n### Group chat\nTo receive messages in a group chat, the adapter needs to been joined(subscribed) in the chat. When the adapter is not \njoined in the group, truncated messages will be received with a slight delay. If auto join is enabled, and the adapter \nreceives a group message for a chat that has not been joined, the adapter will join the chat and than retrieve the full \nmessage and passes it to Hubot. If auto join is disabled the truncated message will be discarded and Hubot will not \nreceive a message.\nMessages in a group, the user.id contains both the user id and the group id to separate the chats artificially within \nthe adapter. This enables users to chat in a one-to-one chat and a group chat at the same time without mixing the chats \nup. To retrieve the user id from a group chat message, the user id is set in the parameter user.user_id.\n\n### Attachments\nAttachments that are received are added to a TextMessage in the parameter attachments.\n\n### User mentions\nIf a user tags a chat member, the mention is added to a TextMessage in the parameter mentions.\nThe \"@All members\" mention is not included\n\n## Events\nWhen an messenger event is received, it is sent to the Hubot instance by a TopicMessage.\n\n### Authentication Events\n* *authenticated*\n\nTopicMessage:\n* *user*: Dummy Hubot user data\n* *text*: \"authenticated\"\n* *id*: Alterdesk user data\n\n### User composing events\n* *typing* \n* *stop_typing*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: \"CHAT_ID\"\n\n### User presence events\n* *presence_update*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"presence_update\"\n* *id*: \"STATUS\"\n\nFor the status *online*, *away* and *busy* an EnterMessage is received. For the status *offline* a LeaveMessage is \nreceived.\n\n### User verified events\n* *conversation_verification_accepted*\n* *conversation_verification_rejected*\n* *groupchat_verification_accepted*\n* *groupchat_verification_rejected*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: \"MESSAGE_ID\"\n\n### Chat events\n* *new_conversation*\n* *new_groupchat*\n* *groupchat_removed*\n* *groupchat_closed*\n* *groupchat_subscribed*\n* *groupchat_unsubscribed*\n\nTopicMessage:\n* *user*: Dummy Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: \"CHAT_ID\"\n\n### Message events\n* *conversation_message_liked*\n* *conversation_message_deleted*\n* *groupchat_message_liked*\n* *groupchat_message_deleted*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: \"MESSAGE_ID\"\n\n### Question answer events\n* *conversation_question_answer*\n* *groupchat_question_answer*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: Alterdesk message data\n\n### Groupchat member events\n* *groupchat_members_added* \n* *groupchat_members_removed*\n\nTopicMessage:\n* *user*: Hubot user data\n* *text*: \"EVENT_NAME\"\n* *id*: Alterdesk member added/removed data\n\n## Example code\nHandling messages in the receiver function of the Hubot instance\n```javascript\n// Check for TopicMessage first, TopicMessage is also an instance of TextMessage\nif(message instanceof TopicMessage) {\n    console.log(\"Event: \" + message.text);\n} else if(message instanceof TextMessage) {\n    \n    var userId;\n    var userInGroup = message.user.user_id != null;\n    if(userInGroup)\n        userId = message.user.user_id;\n    } else {\n        userId = message.user.id;\n    }\n    \n    if(userInGroup) {\n        console.log(\"Received group message from user \" + userId + \" in chat \" + message.room);\n    } else {\n        console.log(\"Received 1-to-1 message from user \" + userId + \" in chat \" + message.room);\n    }\n    \n    // Check and parse attachments\n    var attachments = message.attachments;\n    if(attachments != null) {\n        for(var i in attachments) {\n            var attachment = attachments[i];\n            var attachmentId = attachment[\"id\"]; // Attachment id\n            var filename = attachment[\"name\"];   // File name\n            var mime = attachment[\"mime\"];       // MIME type\n            var size = attachment[\"size\"];       // Size in bytes\n        }\n    }\n    \n    // Check and parse mentions\n    var mentions = message.mentions;\n    if(mentions != null) {\n        for(var i in mentions) {\n            var mention = mention[i];\n            var mentionId = mention[\"id\"];             // User id\n            var userType = mention[\"type\"];            // User type\n            var firstName = mention[\"first_name\"];     // First name\n            var lastName = mention[\"last_name\"];       // Last name\n            var companyName = mention[\"company_name\"]; // Company name\n            var companyId = mention[\"company_id\"];     // Company id\n            var position = mention[\"position\"];        // Job title\n            var avatar = mention[\"avatar\"];            // URL to user avatar image\n            var active = mention[\"active\"];            // User active\n        }\n    }\n    \n} else if(message instanceof EnterMessage) {\n    console.log(\"User is active on messenger: \" + message.user.id);\n} else if(message instanceof LeaveMessage) {\n    console.log(\"User is inactive on messenger: \" + message.user.id);\n}\n```","readmeFilename":"README.md"}